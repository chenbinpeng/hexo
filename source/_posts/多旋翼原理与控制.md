---
title: 多旋翼原理与控制
tags:
  - 多旋翼原理
  - 电机输出分配
categories: 飞行机器人
date: 2016-11-03 15:01:24
---






本文主要总结了多旋翼飞行器的工作原理，包括升降、测飞、转向灯。首先通过四旋翼给出一个直观的解释。然后提取多旋翼飞行器（包括不同形状）的共性，从理论上加以分析。找出飞行器动作控制与电机输出之间的关系。有了这些，在得到当前姿态和目标姿态的差值后就知道如何分配不同电机的输出，以达到想要的结果，是飞控中很关键的一环。



<!-- more -->



### 推力来源

多旋翼飞机的推力来自螺旋桨，由两部分组成，一部分是桨面曲率不同形成的压力差，一部分是桨叶扭角向后推空气时的反作用力。



#### 压力差

压力差来源于伯努利效应。我们知道，当给密闭的空瓶子加热的时候，瓶塞会被瓶内的空气顶出来。这是因为，瓶内空气分子被加热后，获取到了能量，运动速度变快。对瓶塞的压力（也就是撞击力）变大。这也说明了，运动速度快的气体有寻求更大空间的趋势，也就是密度变低。对于开放空间的空气来说，流速越快，密度越小。对平行于流速方向的物体压强越小。这就是伯努利效应。



伯努利效应有很多，包括飞机机翼、喷雾器、体育运动中的旋转球等。先看一个再动物界的有趣应用。下图是非洲草原犬鼠洞穴的横截面示意图，犬鼠的洞穴有两个出口，一个是平的，而另一个则是隆起的土堆，生物学家不是很清楚其中的原因，他们猜想：草原犬鼠把其中一个洞的洞口堆成了包状，是为了建一处视野开阔的嘹望台，但是如果这一假设成立的话，它又为什么不在两个洞口都堆上土包呢?那样不是有两个嘹望台了吗?实际上两个洞口形状不同，决定了洞穴空气的流动方向。吹过平坦表面的空气运动速度小，压强大；吹过隆起表面的空气流速大，压强小。因此，地面上的风吹进了犬鼠的洞穴，给犬鼠带来了阵阵凉风。



 ![犬鼠洞穴](犬鼠洞穴.png)



固定翼飞机也利用了伯努利效应，下图是固定翼飞机的机翼。可以看出其前端圆钝，后端尖锐，上表面拱起，下表面较平。当气流迎面流过机翼时，被分成上下两股，通过机翼后又合在一起。由于机翼上表面拱起，使上方气流通道变窄，流速变大，表面较平，流速较小。这样下表面的压力大于上表面，形成一个向上的压力差，也就是机翼的升力。

 ![固定翼升力](固定翼升力.jpg)



螺旋桨桨叶的前后桨面曲率不一致，形状和固定翼机翼相似，可以把螺旋桨的每一个桨叶看成是一个边旋转边前进的机翼。螺旋桨在旋转时，就像气流流过机翼一样，产生压力差，形成向上的拉力。



#### 空气反作用力

除了桨面曲率不一致，螺旋桨桨叶通常还有一个扭转角。桨叶旋转时把前方的空气吸入，并给吸入的空气一个向下的推力。根据动量守恒，气流会给桨叶一个向上的力，这就是空气的反作用力。



由桨叶异型曲面产生的空气动力与桨叶扭角向后推空气产生的反作用力是同时发生的，这两个力的合力形成螺旋桨的总空气动力。







### 四旋翼结构与原理

关于四旋翼的工作原理，网上有一篇文章介绍的很清楚，下面直接拿来引用。



#### 结构

旋翼对称分布在机体的前后、左右四个方向，四个旋翼处于同一高度平面，且四个旋翼的结构和半径都相同，四个电机对称的安装在飞行器的支架端，支架中间空间安放飞行控制计算机和外部设备。结构如下图所示。

 ![四旋翼结构](四旋翼结构.jpg)





#### 原理

四旋翼飞行器通过调节四个电机转速来改变旋翼转速，实现升力的变化，从而控制飞行器的姿态和位置。四旋翼飞行器是一种六自由度的垂直升降机，但只有四个输入力，同时却有六个状态输出，所以它又是一种欠驱动系统。

 ![四旋翼原理1](四旋翼原理1.jpg)

 ![四旋翼原理2](四旋翼原理2.jpg)



四旋翼飞行器的电机 1和电机 3逆时针旋转的同时，电机 2和电机 4顺时针旋转，因此当飞行器平衡飞行时，陀螺效应和空气动力扭矩效应均被抵消。

在上图中，电机 1和电机 3作逆时针旋转，电机 2和电机 4作顺时针旋转，规定沿 x轴正方向运动称为向前运动，箭头在旋翼的运动平面上方表示此电机转速提高，在下方表示此电机转速下降。

（1）垂直运动：同时增加四个电机的输出功率，旋翼转速增加使得总的拉力增大，当总拉力足以克服整机的重量时，四旋翼飞行器便离地垂直上升；反之，同时减小四个电机的输出功率，四旋翼飞行器则垂直下降，直至平衡落地，实现了沿 z轴的垂直运动。当外界扰动量为零时，在旋翼产生的升力等于飞行器的自重时，飞行器便保持悬停状态。

（2）俯仰运动：在图（b）中，电机 1的转速上升，电机 3 的转速下降（改变量大小应相等），电机 2、电机 4 的转速保持不变。由于旋翼1 的升力上升，旋翼 3 的升力下降，产生的不平衡力矩使机身绕 y 轴旋转，同理，当电机 1 的转速下降，电机 3的转速上升，机身便绕y轴向另一个方向旋转，实现飞行器的俯仰运动。

（3）滚转运动：与图 b 的原理相同，在图 c 中，改变电机 2和电机 4的转速，保持电机1和电机 3的转速不变，则可使机身绕 x 轴旋转（正向和反向），实现飞行器的滚转运动。

（4）偏航运动：旋翼转动过程中由于空气阻力作用会形成与转动方向相反的反扭矩，为了克服反扭矩影响，可使四个旋翼中的两个正转，两个反转，且对角线上的各个旋翼转动方向相同。反扭矩的大小与旋翼转速有关，当四个电机转速相同时，四个旋翼产生的反扭矩相互平衡，四旋翼飞行器不发生转动；当四个电机转速不完全相同时，不平衡的反扭矩会引起四旋翼飞行器转动。在图 d中，当电机 1和电机 3 的转速上升，电机 2 和电机 4 的转速下降时，旋翼 1和旋翼3对机身的反扭矩大于旋翼2和旋翼4对机身的反扭矩，机身便在富余反扭矩的作用下绕 z轴转动，实现飞行器的偏航运动，转向与电机 1、电机3的转向相反。

（5）前后运动：要想实现飞行器在水平面内前后、左右的运动，必须在水平面内对飞行器施加一定的力。在图 e中，增加电机 3转速，使拉力增大，相应减小电机 1转速，使拉力减小，同时保持其它两个电机转速不变，反扭矩仍然要保持平衡。按图 b的理论，飞行器首先发生一定程度的倾斜，从而使旋翼拉力产生水平分量，因此可以实现飞行器的前飞运动。向后飞行与向前飞行正好相反。（在图 b 图 c中，飞行器在产生俯仰、翻滚运动的同时也会产生沿 x、y轴的水平运动。）

（6）倾向运动：在图 f 中，由于结构对称，所以倾向飞行的工作原理与前后运动完全一样。





### 多旋翼分析与控制

从上述四旋翼的工作原理可以看出，实质就是通过电机控制飞机六个自由度的转矩。转矩可以通过外部控制信号（比如遥控器）获得。所以，已知转矩，如何分配电机的输出大小就是一个需要解决的问题。



为了使分析结果具有普遍性，这里对电机的个数和分布位置不做限定。假设飞机有$N​$个电机$R_i​$，$i\subset[1:N]​$，坐标为$(X_i,Y_i,0)​$，$i\subset[1:N]​$，旋转方向为$D_i​$，$i\subset[1:N]​$，$D_i\subset[-1;1]​$，角速度为$\omega_i​$，$i\subset[1:N]​$。则理想情况下每个电机产生的推力可表示为$\vec{F}_i^B=\begin{pmatrix}0\\0\\{-C_t}\omega_i^2\end{pmatrix}​$。电机旋转产生的扭矩为$\begin{pmatrix}0\\0\\D_iC_m\omega_i^2\end{pmatrix}​$。推力产生的力矩可通过推力矢量和电机位置坐标矢量的叉乘来获得。



电机总的力矩即为推力力矩和旋转力矩的和，如下：
$$
\vec{M}_i^B=\begin{pmatrix}X_i\\Y_i\\0\end{pmatrix}\times\begin{pmatrix}0\\0\\{-C_t}\omega_i^2\end{pmatrix}+\begin{pmatrix}0\\0\\D_iC_m\omega_i^2\end{pmatrix}=C_t\omega_i^2\begin{pmatrix}-Y_i\\X_i\\D_i\frac{C_m}{C_t}\end{pmatrix}\\
$$

$C_t$和$C_m$分别为推力系数和旋转力矩系数。可以近似认为电机的推力和转速的平方成正比，于是有$\omega_i^2=Ku_i$。总的力矩如下：

$$
\vec{M}^B=\sum_{i=1}^N\hat{M}_i^B=KC_t\begin{pmatrix}-\sum_{i=1}^NY_iu_i\\\sum_{i=1}^NX_iu_i\\\frac{C_m}{C_t}\sum_{i=1}^ND_iu_i\end{pmatrix}
$$

改写为如下的形式：
$$
\vec{M}^B=KC_t\begin{pmatrix}-Y_1 & -Y_2 & \cdots & -Y_n\\X_1 & X_2 & \cdots & X_n\\\frac{C_m}{C_t}D_1 & \frac{C_m}{C_t}D_2 & \cdots &\frac{C_m}{C_t}D_n &\end{pmatrix}\begin{pmatrix}u_1\\u_2\\\vdots\\u_n\end{pmatrix}
$$

从上式中可以看出，多旋翼飞行器机身受的总力矩$\vec{M}^B$和电机的坐标$(X_n,Y_n)$，电机转向$D_n$，电机转速$u_n$有关。飞行器一旦设计好，电机坐标和转向就定下来了。当需要飞行器做某个动作时，只需输出一定的力矩，力矩又和各个电机的转速有关。

为了方便说明问题，将上式简写为：
$$\vec{M}^B=A\vec{U}$$

其中$A$为$3*N$的矩阵，里面存放的是每个电机的坐标和旋转方向信息。$U$为每个电机需要的输出量，和转速成正比。我们的目的是知道$\vec{M}^B$，求电机输出$U$。

将式子两边乘以$A$的广义逆得：
$$\vec{U}=A^{-1}\vec{M}^B$$

令$B=A^{-1}$，则$B$即为我们需要的混合矩阵。也就是力矩和电机输出之间的关系。



飞控计算出的控制量中，欧拉角信息，实质上和力矩相对应。也就是某个方向的旋转力。比如，若要飞机左右飞行，则需要飞机绕X轴旋转一定的角度，飞控输出反映在roll中。这时只需要根据该矩阵计算出电机需要的转速以提供一个绕X轴的旋转力即可。



### 参考

[为什么气体流速越快压强越小](http://iask.sina.com.cn/b/4519307.html)
[流体压强和流速的关系](http://www.mofangge.com/html/qDetail/04/c3/201110/it8rc30441218.html)
[螺旋桨飞机中，螺旋桨的转速和螺旋桨的大小哪个对螺旋桨产生的前进力影响更大](https://zhidao.baidu.com/question/585305174.html)























